-- Proton Exploit
-- Keyless, Rayfield UI, ULTRA BYPASS + PRIVATE SERVER + AUTO LOAD
-- by fluxu

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Proton",
   LoadingTitle = "Proton Loading...",
   LoadingSubtitle = "by fluxu",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "ProtonConfig",
      FileName = "Proton"
   },
   Discord = {
      Enabled = false
   },
   KeySystem = false
})

-- === SERVICES ===
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local LocalPlayer = Players.LocalPlayer

-- === STATE VARIABLES ===
local AntiKickEnabled = true
local AntiKillEnabled = true
local AntiDisconnectEnabled = true
local DisableStrictACEnabled = true
local AntiGameTPEnabled = true
local AntiFlingEnabled = true
local ESPEnabled = true
local AntiFreezeEnabled = true
local SpeedEnabled = false
local JumpPowerEnabled = false
local AntiPlayerTPEnabled = true
local PrivateServerEnabled = false
local AutoLoadScriptEnabled = true

-- === ESP STORAGE ===
local ESPBoxes = {}
local ESPNames = {}
local ESPTracers = {}

-- === ICON ===
local TabIcon = 4483362458

-- === TABS ===
local SettingsTab = Window:CreateTab("Settings", TabIcon)
local VisualsTab = Window:CreateTab("ESP", TabIcon)
local MovementTab = Window:CreateTab("Movement", TabIcon)
local ServerTab = Window:CreateTab("Server", TabIcon)

-- === SETTINGS TOGGLES ===
SettingsTab:CreateToggle({
   Name = "Anti Kick",
   CurrentValue = true,
   Flag = "AntiKick",
   Callback = function(v) AntiKickEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Anti Kill (Godmode)",
   CurrentValue = true,
   Flag = "AntiKill",
   Callback = function(v) AntiKillEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Anti Disconnect",
   CurrentValue = true,
   Flag = "AntiDisconnect",
   Callback = function(v) AntiDisconnectEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Disable Strict AntiCheat",
   CurrentValue = true,
   Flag = "DisableStrictAC",
   Callback = function(v)
      DisableStrictACEnabled = v
      if v then RunStrictACDisabler() end
   end,
})

SettingsTab:CreateToggle({
   Name = "Anti Game Teleport",
   CurrentValue = true,
   Flag = "AntiGameTP",
   Callback = function(v) AntiGameTPEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Anti Fling (True Noclip)",
   Info = "Noclip with players + tools",
   CurrentValue = true,
   Flag = "AntiFling",
   Callback = function(v) AntiFlingEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Anti Freeze",
   Info = "Prevents stun/anchor",
   CurrentValue = true,
   Flag = "AntiFreeze",
   Callback = function(v) AntiFreezeEnabled = v end,
})

SettingsTab:CreateToggle({
   Name = "Block Player Teleport",
   Info = "Prevents players from teleporting you",
   CurrentValue = true,
   Flag = "AntiPlayerTP",
   Callback = function(v) AntiPlayerTPEnabled = v end,
})

-- === VISUALS TAB ===
VisualsTab:CreateToggle({
   Name = "ESP Boxes",
   CurrentValue = true,
   Flag = "ESPBoxes",
   Callback = function(v)
      ESPEnabled = v
      for _, box in pairs(ESPBoxes) do box.Visible = v end
   end,
})

VisualsTab:CreateToggle({
   Name = "ESP Names",
   CurrentValue = true,
   Flag = "ESPNames",
   Callback = function(v)
      for _, name in pairs(ESPNames) do name.Visible = v end
   end,
})

VisualsTab:CreateToggle({
   Name = "ESP Tracers",
   CurrentValue = true,
   Flag = "ESPTracers",
   Callback = function(v)
      for _, tracer in pairs(ESPTracers) do tracer.Visible = v end
   end,
})

-- === MOVEMENT TAB ===
MovementTab:CreateToggle({
   Name = "Speed (45)",
   CurrentValue = false,
   Flag = "Speed",
   Callback = function(v)
      SpeedEnabled = v
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.WalkSpeed = v and 45 or 16
      end
   end,
})

MovementTab:CreateToggle({
   Name = "Jump Power (80)",
   CurrentValue = false,
   Flag = "JumpPower",
   Callback = function(v)
      JumpPowerEnabled = v
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.JumpPower = v and 80 or 50
      end
   end,
})

-- === SERVER TAB ===
ServerTab:CreateToggle({
   Name = "Create Private Server",
   Info = "Join a tiny, empty server",
   CurrentValue = false,
   Flag = "PrivateServer",
   Callback = function(v)
      PrivateServerEnabled = v
      if v then
         CreatePrivateServer()
      end
   end,
})

ServerTab:CreateToggle({
   Name = "Auto Load Script",
   Info = "Auto-inject on game join",
   CurrentValue = true,
   Flag = "AutoLoadScript",
   Callback = function(v) AutoLoadScriptEnabled = v end,
})

-- === ULTRA BYPASS ===
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)

mt.__namecall = newcclosure(function(self, ...)
   local method = getnamecallmethod()
   if AntiKickEnabled and self == LocalPlayer and (method == "Kick" or method == "kick") then return end
   if AntiGameTPEnabled and method == "TeleportToPlaceInstance" then return end
   if AntiPlayerTPEnabled and method == "SetPrimaryPartCFrame" and self == LocalPlayer.Character then return end
   if AntiPlayerTPEnabled and method == "MoveTo" and self == LocalPlayer.Character then return end
   return oldNamecall(self, ...)
end)

setreadonly(mt, true)

-- === GODMODE ===
local function ApplyGodMode(char)
   if not char or not AntiKillEnabled then return end
   task.spawn(function()
      local hum = char:FindFirstChildOfClass("Humanoid")
      if hum then
         hum.Health = math.huge
         hum.MaxHealth = math.huge
         hum.BreakJoints = function() end
         for _, state in pairs(Enum.HumanoidStateType:GetEnumItems()) do
            pcall(hum.SetStateEnabled, hum, state, false)
         end
      end
   end)
end

LocalPlayer.CharacterAdded:Connect(function(char)
   ApplyGodMode(char)
   task.wait()
   if SpeedEnabled and char:FindFirstChild("Humanoid") then char.Humanoid.WalkSpeed = 45 end
   if JumpPowerEnabled and char:FindFirstChild("Humanoid") then char.Humanoid.JumpPower = 80 end
end)

if LocalPlayer.Character then ApplyGodMode(LocalPlayer.Character) end

-- === ANTI FREEZE ===
RunService.Stepped:Connect(function()
   if not AntiFreezeEnabled or not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return end
   local root = LocalPlayer.Character.HumanoidRootPart
   if root.Anchored then root.Anchored = false end
end)

-- === TRUE NOCLIP ===
RunService.Stepped:Connect(function()
   if not AntiFlingEnabled or not LocalPlayer.Character then return end
   for _, part in ipairs(LocalPlayer.Character:GetDescendants()) do
      if part:IsA("BasePart") then part.CanCollide = false end
   end
   for _, plr in ipairs(Players:GetPlayers()) do
      if plr ~= LocalPlayer and plr.Character then
         for _, obj in ipairs(plr.Character:GetDescendants()) do
            if obj:IsA("BasePart") and (obj.Parent:FindFirstChild("Humanoid") or obj:IsA("Tool") or obj.Parent:IsA("Tool")) then
               obj.CanCollide = false
            end
         end
      end
   end
end)

-- === ESP SYSTEM ===
local function CreateESP(plr)
   if plr == LocalPlayer or not plr.Character then return end
   local box = Drawing.new("Square")
   box.Thickness = 2
   box.Filled = false
   box.Color = Color3.fromRGB(255, 0, 0)
   box.Visible = false
   ESPBoxes[plr] = box

   local name = Drawing.new("Text")
   name.Text = plr.Name
   name.Size = 16
   name.Center = true
   name.Outline = true
   name.Color = Color3.fromRGB(255, 255, 255)
   name.Visible = false
   ESPNames[plr] = name

   local tracer = Drawing.new("Line")
   tracer.Thickness = 1
   tracer.Color = Color3.fromRGB(0, 255, 0)
   tracer.Visible = false
   ESPTracers[plr] = tracer
end

local function UpdateESP()
   if not ESPEnabled then return end
   for plr, box in pairs(ESPBoxes) do
      if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr.Character:FindFirstChild("Head") then
         local root = plr.Character.HumanoidRootPart
         local head = plr.Character.Head
         local cam = Workspace.CurrentCamera
         local screenPos, onScreen = cam:WorldToViewportPoint(root.Position)
         if onScreen then
            local size = (cam:WorldToViewportPoint(root.Position - Vector3.new(0, 3, 0)).Y - cam:WorldToViewportPoint(root.Position + Vector3.new(0, 3, 0)).Y) / 2
            box.Size = Vector2.new(size * 2, size * 3)
            box.Position = Vector2.new(screenPos.X - box.Size.X / 2, screenPos.Y - box.Size.Y / 2)
            box.Visible = true

            local namePos = cam:WorldToViewportPoint(head.Position + Vector3.new(0, 1, 0))
            ESPNames[plr].Position = Vector2.new(namePos.X, namePos.Y)
            ESPNames[plr].Visible = true

            ESPTracers[plr].From = Vector2.new(cam.ViewportSize.X / 2, cam.ViewportSize.Y)
            ESPTracers[plr].To = Vector2.new(screenPos.X, screenPos.Y)
            ESPTracers[plr].Visible = true
         else
            box.Visible = false
            ESPNames[plr].Visible = false
            ESPTracers[plr].Visible = false
         end
      else
         box.Visible = false
         ESPNames[plr].Visible = false
         ESPTracers[plr].Visible = false
      end
   end
end

for _, plr in ipairs(Players:GetPlayers()) do
   if plr ~= LocalPlayer then CreateESP(plr) end
end

Players.PlayerAdded:Connect(function(plr)
   plr.CharacterAdded:Connect(function()
      task.wait(1)
      CreateESP(plr)
   end)
end)

RunService.RenderStepped:Connect(UpdateESP)

-- === PRIVATE SERVER CREATOR ===
function CreatePrivateServer()
   local servers = {}
   local req = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
   for _, v in pairs(req.data) do
      if v.playing <= 1 and v.id ~= game.JobId then
         table.insert(servers, v.id)
      end
   end
   if #servers > 0 then
      TeleportService:TeleportToPlaceInstance(game.PlaceId, servers[1], LocalPlayer)
   else
      -- Fallback: try any server under 3 players
      local fallback = {}
      for _, v in pairs(req.data) do
         if v.playing < 3 and v.id ~= game.JobId then
            table.insert(fallback, v.id)
         end
      end
      if #fallback > 0 then
         TeleportService:TeleportToPlaceInstance(game.PlaceId, fallback[1], LocalPlayer)
      else
         Rayfield:Notify({Title="Private Server", Content="No empty server found!", Duration=3})
      end
   end
end

-- === AUTO LOAD SCRIPT (Persistent Injection) ===
if AutoLoadScriptEnabled then
   local scriptUrl = "https://raw.githubusercontent.com/fluxusdev/proton/main/load.lua"
   task.spawn(function()
      while task.wait(5) do
         if not Rayfield or not Rayfield.Loaded then
            pcall(function()
               loadstring(game:HttpGet(scriptUrl))()
            end)
         end
      end
   end)
end

-- === NUCLEAR ANTICHEAT BYPASS ===
local blocked = {
   "anticheat","ac","anti","exploit","cheat","security","protector","adonis","krystal","eclipse",
   "fates","hdadmin","admin","kohls","detect","check","validator","integrity","synapse","fluxus",
   "brainrot","rot","bypass","fe","script","localscript","module","remote","event","function",
   "kick","ban","report","log","debug","assert","error","warn","print","require","getfenv"
}

local function isSuspicious(obj)
   if not obj or not obj.Name then return false end
   local n = obj.Name:lower()
   for _, k in blocked do
      if n:find(k) then return true end
   end
   return false
end

local function RunStrictACDisabler()
   if not DisableStrictACEnabled then return end
   for _, obj in ipairs(game:GetDescendants()) do
      if obj:IsA("Script") or obj:IsA("LocalScript") or obj:IsA("ModuleScript") or obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then
         if isSuspicious(obj) then pcall(obj.Destroy, obj) end
      end
   end
   local oldReq = require
   require = newcclosure(function(mod)
      if isSuspicious(mod) then
         return setmetatable({}, {__index = function() return function() end end})
      end
      return oldReq(mod)
   end)
   game.DescendantAdded:Connect(function(obj)
      if DisableStrictACEnabled and (obj:IsA("Script") or obj:IsA("LocalScript") or obj:IsA("RemoteEvent")) then
         if isSuspicious(obj) then task.defer(function() pcall(obj.Destroy, obj) end) end
      end
   end)
end

if DisableStrictACEnabled then RunStrictACDisabler() end

-- === SILENT LOAD ===
Rayfield:LoadConfiguration()
